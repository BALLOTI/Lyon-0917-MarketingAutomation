
{% extends 'base.html.twig' %}

{% block title %} Votre recherche :  {{ research }} - Logiciel de Marketing Automation {% endblock %}

{% block body %}
    <div class="result" id="results">
        <div class="row">


            <div class="col s12 m7 l7">
                <p class="presults">{% if softwares|length > 1 %}  {{ softwares|length }} résultats pour votre recherche : {{ research }}
                    {% endif %}
                    {% if softwares|length < 2 %}  {{ softwares|length }} Résultat pour votre recherche : {{ research }}
                    {% endif %}

                </p>
                {% if softwares|length < 1 %}   <p>Votre recherche n'est pas assez précise. Essayez de mieux décrire votre recherche</p>
{% endif %}

                <div class="center-align hide-on-med-and-up">
                    <a href="#" data-activates="slide-out" class="button-collapse btn-large"><i
                                class="material-icons">edit</i>Plus de critères</a>
                </div>
<div v-for="software in sofwarefiltres">

    <div class="card horizontal">

        <div class="marginLogo">
            <div class="card-image result-logo-responsive">
                <a :href="`/logiciels/${software.slug}`"><img class="responsive-img" :src="`/assets/img/logo/${software.slug}.png`"></a>
            </div>
        </div>
        <div class="card-stacked">
            <div class="card-action">
                <a :href="`/logiciels/${software.slug}`">${ software.name }</a>
            </div>
            <div class="card-content">
                <p class="troncate">${ software.description }</p>
            </div>

        </div>

    </div>
</div>
</div>

{% include('filters.html.twig') %}




</div>


</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.3/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.17.1/axios.js"></script>
<script>
    var app = new Vue({
        delimiters: ['${', '}'],
        el: '.result',
        data: {
            softwaresList : [],
            sms: false,
            mail: false,
            rgpd: false,
            popin: false,
            mailpostal: false,
            callCenter: false,
            pushmobile: false,
            api: false,
            reportcreation: false,
            reportperiodic: false,
            emailsupport: false,
            phonesupport: false,
            chatsupport: false,
            landing: false,
            formulaire: false,
            codesuivi: false,
            livechat: false,
            knowledgebase: false,
            technicalDoc: false,
            twitterMon: false,
            twitterAuto: false,
            linkedinAuto: false,
            linkedinMon: false,
            instagramMon: false,
            instagramAuto: false,
            facebookMon: false,
            facebookAuto: false,
            SegmentCreation: false,
            IntelligentSegmentCreation: false,
            AutoResponder: false,
            LeadScoring: false,
            CreationCampaign: false,
            DripMarketingCampaign: false,
            DragAndDrop: false,
            ContactObject: false,
            CompanyObject: false,
            DefinedFields: false,
            IllimitedFields: false,
            ImportCsv: false,
            AutoDuplicate: false,
            LeadStages: false,
            ProviderEmailChoice: false,
            BlogEdition: false,
            TouchPad: false,
            RssToEmail: false,
            SmtpRelay: false,
            price: "",
        },
        created(){
            axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';

            axios.get('/results_{{ research }}', {
                headers: {
                    'Content-Type': 'application/json'
                },
                transformResponse: axios.defaults.transformResponse.concat((data) => {
                    this.softwaresList = data.data
                })
            })
        },
        computed: {

            sofwarefiltres: function(){
                let condFbMon = true;
                let condFbAuto = true;
                let condInstagramMon = true;
                let condinstragramAuto = true;
                let condlinkedinAuto = true;
                let condlinkedinMon = true;
                let condtwitterMon = true;
                let condtwitterAuto= true;
                let condSms = true;
                let condMail = true;
                let condRgpd = true;
                let condPopin = true;
                let condMailPostal = true;
                let condCallCenter = true;
                let condPushmobile = true;
                let condisApi = true;
                let condReportCreation = true;
                let condReportPeriodic = true;
                let condEmailSupport = true;
                let condPhoneSupport = true;
                let condChatSupport = true;
                let condLanding = true;
                let condForm = true;
                let condCodesuivi = true;
                let condLivechat = true;
                let condisKnowledgeBase = true;
                let condTechnicalDoc = true;
                let condSegmentCreation = true;
                let condIntelligentSegmentCreation = true;
                let condAutoResponder = true;
                let condLeadScoring = true;
                let condisCreationCampaign = true;
                let condisDripMarketingCampaign = true;
                let condisDragAndDrop = true;
                let condisContactObject = true;
                let condisCompanyObject = true;
                let condisDefinedFields = true;
                let condisIllimitedFields = true;
                let condisImportCsv = true;
                let condisAutoDuplicate = true;
                let condisLeadStages = true;
                let condisProviderEmailChoice = true;
                let condisisBlogEdition = true;
                let condisisTouchPad = true;
                let condisRssToEmail = true;
                let condisSmtpRelay = true;
                let conditionPrice = true;
                let reg = new RegExp(this.price, "i");


                return this.softwaresList.filter((elt) => {
                    if(this.facebookMon === true){
                        condFbMon = elt.isFbMon
                    }
                    if(this.price === true){
                        conditionPrice = elt.isFbMon
                    }
                    if(this.SmtpRelay === true){
                        condisSmtpRelay = elt.isSmtpRelay
                    }
                    if(this.RssToEmail === true){
                        condisRssToEmail = elt.isRssToEmail
                    }
                    if(this.TouchPad === true){
                        condisisTouchPad = elt.isTouchPad
                    }
                    if(this.BlogEdition === true){
                        condisisBlogEdition = elt.isBlogEdition
                    }
                    if(this.ProviderEmailChoice === true){
                        condisProviderEmailChoice = elt.isProviderEmailChoice
                    }
                    if(this.LeadStages === true){
                        condisLeadStages = elt.sLeadStages
                    }
                    if(this.AutoDuplicate === true){
                        condisAutoDuplicate = elt.isAutoDuplicate
                    }
                    if(this.ImportCsv === true){
                        condisImportCsv = elt.isImportCsv
                    }
                    if(this.IllimitedFields === true){
                        condisIllimitedFields = elt.isIllimitedFields
                    }
                    if(this.DefinedFields === true){
                        condisDefinedFields = elt.isDefinedFields
                    }
                    if(this.CompanyObject === true){
                        condisCompanyObject = elt.isCompanyObject
                    }
                    if(this.ContactObject === true){
                        condisContactObject = elt.isContactObject
                    }
                    if(this.DragAndDrop === true){
                        condisDragAndDrop = elt.isDragAndDrop
                    }
                    if(this.DripMarketingCampaign === true){
                        condisDripMarketingCampaign = elt.isDripMarketingCampaign
                    }
                    if(this.CreationCampaign === true){
                        condisCreationCampaign = elt.isCreationCampaign
                    }
                    if(this.LeadScoring === true){
                        condLeadScoring = elt.isLeadScoring
                    }
                    if(this.AutoResponder === true){
                        condAutoResponder = elt.isAutoResponder
                    }
                    if(this.IntelligentSegmentCreation === true){
                        condIntelligentSegmentCreation = elt.isIntelligentSegmentCreation
                    }
                    if(this.facebookAuto === true){
                        condFbAuto = elt.isFbAuto
                    }
                    if(this.SegmentCreation === true){
                        condSegmentCreation = elt.isSegmentCreation
                    }
                    if(this.twitterAuto === true){
                        condtwitterAuto = elt.isTwitterAutoPublication
                    }
                    if(this.twitterMon === true){
                        condtwitterMon = elt.isTwitterMonitoring
                    }
                    if(this.linkedinAuto === true){
                        condlinkedinAuto = elt.isLinkedinAutoPublication
                    }
                    if(this.linkedinMon === true){
                        condlinkedinMon = elt.isLinkedinMonitoring
                    }
                    if(this.instagramMon === true){
                        condInstagramMon = elt.isInstagramMonitoring
                    }
                    if(this.instagramAuto === true){
                        condinstragramAuto = elt.isInstagramAutoPublication
                    }

                    if(this.knowledgebase === true){
                        condisKnowledgeBase = elt.isKnowledgeBase
                    }

                    if(this.knowledgebase === true){
                        condisKnowledgeBase = elt.isKnowledgeBase
                    }
                    if(this.technicalDoc === true){
                        condTechnicalDoc = elt.isTechnicalDocument
                    }

                    if(this.formulaire === true){
                        condForm = elt.isForm
                    }
                    if(this.codesuivi === true){
                        condCodesuivi = elt.isTracking
                    }
                    if(this.livechat === true){
                        condLivechat = elt.isLiveChat
                    }
                    if(this.sms === true){
                        condSms = elt.isSms
                    }
                    if(this.rgpd === true){
                        condRgpd = elt.isRgpd
                    }
                    if(this.mail === true){
                        condMail = elt.isEmail
                    }
                    if(this.popin === true){
                        condPopin = elt.isPopin
                    }
                    if(this.mailpostal === true){
                        condMailPostal = elt.isMailPostal
                    }
                    if(this.callCenter === true){
                        condCallCenter = elt.isCallCenter
                    }
                    if(this.pushmobile === true){
                        condPushmobile = elt.isPushMobile
                    }
                    if(this.api === true){
                        condisApi = elt.isApi
                    }
                    if(this.reportcreation === true){
                        condReportCreation = elt.isActivityReportCreation
                    }
                    if(this.reportperiodic === true){
                        condReportPeriodic = elt.isActivityReportPeriodicSend
                    }
                    if(this.emailsupport === true){
                        condEmailSupport = elt.isEmailSupport
                    }
                    if(this.phonesupport === true){
                        condPhoneSupport = elt.isPhoneSupport
                    }
                    if(this.chatsupport === true){
                        condChatSupport = elt.isChatSupport
                    }
                    if(this.landing === true){
                        condLanding = elt.isLandingPage
                    }

                    return  condSms &&
                        condMail &&
                        condRgpd &&
                        condPopin &&
                        condCallCenter &&
                        condMailPostal &&
                        condPushmobile &&
                        condisApi &&
                        condReportCreation &&
                        condReportPeriodic &&
                        condPhoneSupport &&
                        condEmailSupport &&
                        condChatSupport &&
                        condLanding  &&
                        condForm &&
                        condCodesuivi &&
                        condisKnowledgeBase &&
                        condTechnicalDoc &&
                        condLivechat &&
                        condInstagramMon &&
                        condinstragramAuto &&
                        condlinkedinAuto &&
                        condlinkedinMon &&
                        condtwitterMon &&
                        condtwitterAuto &&
                        condSegmentCreation &&
                        condIntelligentSegmentCreation &&
                        condLeadScoring &&
                        condisCreationCampaign &&
                        condisDripMarketingCampaign &&
                        condisDragAndDrop &&
                        condisContactObject &&
                        condisCompanyObject &&
                        condisDefinedFields &&
                        condisIllimitedFields &&
                        condisImportCsv &&
                        condisLeadStages &&
                        condisAutoDuplicate &&
                        condisProviderEmailChoice &&
                        condisisBlogEdition &&
                        condisisTouchPad &&
                        condisRssToEmail &&
                        condAutoResponder &&
                            reg.test(elt.isPrice)
                        ;
                });

            }
        }

    });

</script>
{% endblock %}
{% block javascripts %}{{ parent() }}
    <script type="text/javascript" src="{{ asset('assets/js/application.filters.js') }}"></script>
    <script type="text/javascript" src="{{ asset('assets/js/nouislider.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('assets/js/resultHide.js') }}"></script>
{% endblock %}